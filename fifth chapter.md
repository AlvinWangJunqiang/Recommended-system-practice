# 利用上下文信息
## 时间上下文信息
### 时间效应简介
时间信息息对用户兴趣的影响表现在以下几个方面：
* 用户兴趣是变化的
* 物品也是有生命周期的
* 季节效应 
### 系统时间特性的分析
1. 时间特性的体现：

	* 数据集每天独立用户数的增长情况
	* 系统的物品变化情况
	* 用户访问情况（用户访问频率）

2. 物品的生存周期和系统的时效性

	* 物品平均在线天数
	* 相隔T天系统物品流行度向量的平均相似度

3. 推荐系统的实时性
实时推荐系统的实时性除了对用户行为的存取有实时性要求，还要求推荐算法本身具有实时性，而推荐算法本身的实时性意味着：

	* 实时推荐系统不能每天都给所有用户离线计算推荐结果，然后在线展示昨天计算出来的结果。所以，要求在每个用户访问推荐系统时，都根据用户这个时间点前的行为实时计算推荐列表。
	* 推荐算法需要平衡考虑用户的近期行为和长期行为，即要让推荐列表反应出用户近期行为所体现的兴趣变化，又不能让推荐列表完全受用户近期行为的影响，要保证推荐列表对用户兴趣预测的延续性。

4. 推荐算法的时间多样性
	推荐系统每天推荐结果的变化程度被定义为推荐系统的时间多样性。时间多样性高的推荐系统中用户会经常看到不同的推荐结果。

	* 首先，需要保证推荐系统能够在用户有了新的行为后及时调整推荐结果，使推荐结果满足用户最近的兴趣；
	* 其次，需要保证推荐系统在用户没有新的行为时也能够经常变化一下结果，具有一定的时间多样性。

	解决办法：

	* 在生成推荐结果时加入一定的随机性。
	* 记录用户每天看到的推荐结果，然后在每天给用户进行推荐时，对他前几天看到过很多次的推荐结果进行适当地降权。
	* 每天给用户使用不同的推荐算法。
5. 时间上下文推荐算法
	1. 最近最热门</br>
	
	![最近最热门](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic34.png?raw=true)
    2. 时间上下文相关的ItemCF算法</br>
    	ItemCF的核心

		*  利用用户行为离线计算物品之间的相似度
		*  根据用户的历史行为和物品相似度矩阵，给用户做在线个性化推荐。</br>
		
		时间信息的重要应用

		*  物品相似度：用户在相隔很短的时间内喜欢的物品具有更高相似度。
		*  在线推荐：用户近期行为相比用户很久之前的行为，更能体现用户现在的兴趣。</br>
		![时间上下文相关的ItemCF算法](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic35.png?raw=true)</br>
        ![考虑时间信息对预测公式的影响](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic36.png?raw=true)</br>
        ![考虑时间信息对预测公式的影响](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic37.png?raw=true)</br>
	3. 时间上下文相关的UserCF算法
		可以在以下两个方面利用时间信息改进UserCF算法：
        	* 用户兴趣相似度 
        	* 相似兴趣用户的最近行为 
        ![对共同喜欢的物品加了一个时间衰减因子](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic38.png?raw=true)
         ![对r加了一个时间衰减因子](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic39.png?raw=true)
## 地点上下文信息
### 基于位置的推荐算法
1. 数据集有三种不同的形式
	* （用户，用户位置，物品，评分），每一条记录代表了某一个地点的用户对物品的评分。它们使用的是MovieLens数据集。该数据集给出了用户的邮编，从而可以知道用户的大致地址。
	* （用户，物品，物品位置，评分），每一条记录代表了用户对某个地方的物品的评分。LARS使用了FourSquare的数据集，该数据集包含用户对不同地方的餐馆、景点、商店的评分。
	* （用户，用户位置，物品，物品位置，评分），每一条记录代表了某个位置的用户对某个位置的物品的评分。
2. 发现了用户兴趣和地点相关的两种特征：
	* 兴趣本地化：不同地方的用户兴趣存在着很大的差别。
	* 活动本地化：一个用户往往在附近的地区活动。
3. 针对三种数据集的方法
	1. 对于第一种数据集，LARS的基本思想是将数据集根据用户的位置划分成很多子集。因为位置信息是一个树状结构，比如国家、省、市、县的结构。因此，数据集也会划分成一个树状结构。然后，给定每一个用户的位置，我们可以将他分配到某一个叶子节点中，而该叶子节点包含了所有和他同一个位置的用户的行为数据集。然后，LARS就利用这个叶子节点上的用户行为数据，通过ItemCF给用户进行推荐。不过这样做的缺点是，每个叶子节点上的用户数量可能很少，因此他们的行为数据可能过于稀疏，从而无法训练出一个好的推荐算法。为此，我们可以从根节点出发，在到叶子节点的过程中，利用每个中间节点上的数据训练出一个推荐模型，然后给用户生成推荐列表。而最终的推荐结果是这一系列推荐列表的加权。
	2. </br> ![第二种数据集的解决办法](https://github.com/easezyc/Recommended-system-practice/blob/master/pics/pic39.png?raw=true)
	3. 从第三种数据集的定义可以看到，它相对于第二种数据集增加了用户当前位置这一信息。而在给定了这一信息后，我们应该保证推荐的物品应该距离用户当前位置比较近，在此基础上再通过用户的历史行为给用户推荐离他近且他会感兴趣的物品。